<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Novel</title>
</head>
<body>

<div id="novel"></div>
<ul id="chapters"></ul>

<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="assets/js/supabase.js"></script>
<script>
const id = new URLSearchParams(location.search).get("id");

async function load() {
  const { data: novel } = await supabase
    .from("novels")
    .select("*")
    .eq("id", id)
    .single();

  const { data: chapters } = await supabase
    .from("chapters")
    .select("*")
    .eq("novel_id", id)
    .order("chapter_order");

  document.getElementById("novel").innerHTML = `
    <h1>${novel.title}</h1>
    <p>${novel.description}</p>
  `;

  document.getElementById("chapters").innerHTML =
    chapters.map(c =>
      `<li><a href="read.html?id=${c.id}">${c.title}</a></li>`
    ).join("");
}
load();
</script>
</body>
</html>
